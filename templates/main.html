<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>æ¸¯çº¦,å¯»æ‰¾å¿—åŒé“åˆ</title>
    <link rel="icon" type="image/gif" href="../static/img/xjtu.gif" />
    <!-- æ–° Bootstrap æ ¸å¿ƒ CSS æ–‡ä»¶ -->
    <link rel="stylesheet" href="../static/css/bootstrap.min.css">
    <!-- jQueryæ–‡ä»¶ã€‚åŠ¡å¿…åœ¨bootstrap.min.js ä¹‹å‰å¼•å…¥ -->
    <script src="../static/js/jquery-3.4.1.min.js"></script>
    <!-- popper.min.js ç”¨äºå¼¹çª—ã€æç¤ºã€ä¸‹æ‹‰èœå• -->
    <script src="https://cdn.bootcss.com/popper.js/1.12.5/umd/popper.min.js"></script>
    <!-- æœ€æ–°çš„ Bootstrap4 æ ¸å¿ƒ JavaScript æ–‡ä»¶ -->
    <script src="../static/js/bootstrap.min.js"></script>
    <style>
        body{
            background-image: url(../static/img/mainpage_bg.png);
            background-attachment:fixed;
        }

        .box{
            position:fixed;
            right:15px;
            bottom: 20px;
            height:50px;
            width: 50px;    
            text-align:center;
            padding-top:20px;    
            background-color: lightblue;
            border-radius: 20%;
            overflow: hidden;
        }

        .box:hover{

            cursor:pointer;
        }

        .box-in{
            visibility: visible;
            display:inline-block;
            height:20px;
            width: 20px;
            border: 3px solid black;
            border-color: white transparent transparent white;
            transform:rotate(45deg);
        }

    </style>
</head> 

<body>
    <div class="container" name="top">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div class="row clearfix">
                    <div class="col-md-2 column">
                    </div>
                    <div class="col-md-8 column">
                        <nav class="navbar navbar-expand-sm bg-dark navbar-dark fixed-top">
                            <a class="navbar-brand" href="#">
                                <img src="../static/img/white-title.png" alt="logo" style="width:130px;">
                            </a>
                            <ul class="navbar-nav">
                                <li class="nav-item active">
                                    <a class="nav-link" href="#"><strong>å¸–å­</strong></a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="/post_new"><strong>å‘å¸ƒ</strong></a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="/user_info"><strong>ä¸ªäººä¿¡æ¯</strong></a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="/logout"><strong>é€€ å‡º</strong></a>
                                </li>
                            </ul>
                            <!-- å¯¼èˆªæ å±…å³çš„å†™æ³• justify-content-end -->
                            <div class="collapse navbar-collapse justify-content-end">
                                <ul class="navbar-nav">
                                    <form class="form-inline" action="/search/1" method="POST" id="searchForm">
                                        <div class="input-group">
                                            <input type="text" id="searchValue" class="form-control" placeholder="åœ¨æ­¤è¾“å…¥..." name="searchValue">
                                            <div class="input-group-append">
                                              <span style="cursor: pointer;" id="searchBtn" onclick="search();" class="input-group-text">ğŸ”</span>
                                            </div>
                                          </div>

                                    </form>

                                </ul>
                            </div>
                        </nav>
                        <br><br><br><br>
                        <h1>Hello {{ userName }}!</h1>
                        <hr />
                        {% for item in posts %}
                        <div class="card">
                            <div class="card-header bg-info text-white">
                                <h4>titleï¼š{{ item.title }}</h4>
                            </div>
                            <div class="card-body bg-light text-dark">
                                <li>categoryï¼š{{ item.category }}</li>
                                <li>added_timeï¼š{{ item.added_time }}</li>
                                <li>user_idï¼š{{ item.user_id }}</li>
                            </div>
                            <div class="card-footer bg-secondary text-white">
                                <form>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">ç•™è¨€ï¼š</span>
                                        </div>
                                        <input type="text" class="form-control" placeholder="å†™ä¸‹ä½ æƒ³è¯´çš„..">
                                    </div>
                                    <button type="button">
                                        <span>submit</span>
                                    </button>
                                </form>
                            </div>
                            <br>
                            <hr />
                            {% endfor %}

                            {%import 'pages.html' as pg%}
                            {{pg.my_paginate(pagination,'main')}}
                        </div>
                    </div>
                    <div class="col-md-2 column">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- æ¨¡æ€æ¡† -->
    <div class="modal fade" id="myModal">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <!-- æ¨¡æ€æ¡†å¤´éƒ¨ -->
                <div class="modal-header">
                    <h4 class="modal-title">æ ç¤º</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <!-- æ¨¡æ€æ¡†ä¸»ä½“ -->
                <div class="modal-body">
                    <p id="alerttext">æ£€ç´¢å†…å®¹ä¸èƒ½ä¸ºç©º...</p>
                </div>
                <!-- æ¨¡æ€æ¡†åº•éƒ¨ -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">å…³é—­</button>
                </div>
            </div>
        </div>
    </div>
    <div id="box" class="box">
        <div class="box-in"></div>
    </div> 
    <script type="text/javascript">

        var timer  = null;
        box.onclick = function(){
            cancelAnimationFrame(timer);
            //è·å–å½“å‰æ¯«ç§’æ•°
            var startTime = +new Date();     
            //è·å–å½“å‰é¡µé¢çš„æ»šåŠ¨é«˜åº¦
            var b = document.body.scrollTop || document.documentElement.scrollTop;
            var d = 700;
            var c = b;
            timer = requestAnimationFrame(function func(){
                var t = d - Math.max(0,startTime - (+ new Date()) + d);
                document.documentElement.scrollTop = document.body.scrollTop = t * (-c) / d + b;
                timer = requestAnimationFrame(func);
                if(t == d){
                cancelAnimationFrame(timer);
                
                }
            });
        }
        function search() {
            let searchValue = document.getElementById("searchValue").value;
            console.log(searchValue);
            if (searchValue == "") {
                document.getElementById("alerttext").innerText = "æ£€ç´¢å†…å®¹ä¸èƒ½ä¸ºç©º..."
                $("#myModal").modal();
            } else {
                $("#searchForm").submit();
                // $.ajax({
                //     type: 'POST',
                //     url: "/search/1",
                //     data: {
                //         searchValue: searchValue,
                //     },
                //     cache: false,
                //     error: function (err) {
                //         document.getElementById("alerttext").innerText = "æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œè¯·ç¨åå†è¯•..."
                //         $("#myModal").modal();
                //     },
                //     success: function (data) {
                //         if (data == "Query null") {
                //             document.getElementById("alerttext").innerText = "æ²¡æœ‰æ‰¾åˆ°ç›¸å…³æ£€ç´¢å†…å®¹..."
                //             $("#myModal").modal();
                //         } else {
                //             document.getElementById("alerttext").innerText = "æ£€ç´¢ä¸­..."
                //             $("#myModal").modal();
                //             setTimeout(function () {
                //                 $("#ajaxUpdate").html(data);
                //             }, 2000);
                //         }
                //     }
                // });
            }
        }
    </script>
</body>

</html>